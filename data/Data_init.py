import numpy as np
from scipy.io import loadmat
from scipy.sparse import csc_matrix
from scipy.sparse.linalg import factorized

##        reading post-fault initial condition from the mat-file
temp = loadmat('./data/init_ne.mat', struct_as_record=True)
X0 = temp['X']
Vbus0 = temp['Vbus']
nobus = len(Vbus0)
solveYbus_L = factorized(csc_matrix(temp['Ybus_L']))
solveYbus_U = factorized(csc_matrix(temp['Ybus_U']))
idxYbus = temp['idxYbus'][0]-1
idxYbus_rev = temp['idxYbus_rev'][0]-1
idxGenBus = temp['idxGenBus'][0]-1
nogen = len(idxGenBus)
idxGenBus_new = np.unique(idxGenBus)
idxGen = temp['idxGen'][0]-1
idxdelta = temp['idxdelta'][0]-1
idxsm = temp['idxsm'][0]-1
idxsif = temp['idxsif'][0]-1
idxsih = temp['idxsih'][0]-1
idxsig = temp['idxsig'][0]-1
idxsik = temp['idxsik'][0]-1
idxEdc = temp['idxEdc'][0]-1
idxXadspp = temp['idxXadspp'][0]-1
idxXaqspp = temp['idxXaqspp'][0]-1
idxGov = temp['idxGov'][0]-1
idxTurb = temp['idxTurb'][0]-1
idxExc = temp['idxExc'][0]-1
idxEfd = temp['idxEfd'][0]-1
idxV2 = temp['idxV2'][0]-1
idxV1 = temp['idxV1'][0]-1
idxVR = temp['idxVR'][0]-1
Vref = temp['Vref']
Pc = temp['Pc']
GENMVA = temp['GENMVA']
Xfl = temp['Xfl']
Xhl = temp['Xhl']
Xgl = temp['Xgl']
Xkl = temp['Xkl']
Xl = temp['Xl']
Ra = temp['Ra']
Asd = temp['Asd']
Bsd = temp['Bsd']
siTd = temp['siTd']
Asq = temp['Asq']
Bsq = temp['Bsq']
siTq = temp['siTq']
Xadu = temp['Xadu']
Xaqu = temp['Xaqu']
Rf = temp['Rf']
Rh = temp['Rh']
Rk = temp['Rk']
Rg = temp['Rg']
H = temp['H']
D = temp['D']
Tc = temp['Tc']
wB = temp['wB']
Txd = temp['Txd']
Txq = temp['Txq']
RD = temp['RD']
TSV = temp['TSV']
Psvmax = temp['Psvmax']
Psvmin = temp['Psvmin']
TCH = temp['TCH']
KA = temp['KA']
TA = temp['TA']
KE = temp['KE']
TE = temp['TE']
KF = temp['KF']
TF = temp['TF']
AE = temp['AE']
BE = temp['BE']
VRmax = temp['VRmax']
VRmin = temp['VRmin']
TR = temp['TR']
ui = temp['ui']
xi = temp['xi']
d_delta = temp['d_delta']
d_thres = temp['d_thres'][0][0]
d_ref = temp['d_ref'][0][0]-1
A = csc_matrix(temp['A'])
B = csc_matrix(temp['B'])
VL0 = temp['VL0']
PL0 = temp['PL0']
QL0 = temp['QL0']
idxLoadBus = temp['idxLoadBus'][0]-1
noload = len(idxLoadBus)
a1 = temp['a1']
a2 = temp['a2']
a3 = temp['a3']
b1 = temp['b1']
b2 = temp['b2']
b3 = temp['b3']
idxILr = temp['idxILr'][0]-1
idxILi = temp['idxILi'][0]-1
TLr = temp['TLr']
TLi = temp['TLi']
idxLoad = temp['idxLoad'][0]-1
